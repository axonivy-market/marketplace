<div class="container p-0">
    <!-- Search Bar -->
    <div class="flex-grow-1 d-flex align-items-center justify-content-between">
      <app-product-filter class="flex-grow-1 w-100" (searchChange)="onSearchChanged($event)"
        [isProductHomepage]="false">
      </app-product-filter>
      <div class="btn-group ps-3 py-3" role="group">
      <input type="radio" class="btn-check" [attr.name]="'mode-' + activeTab" [id]="'defaultMode-' + activeTab"
        autocomplete="off" [(ngModel)]="mode[activeTab]" value="default">
      <label class="btn btn-outline-primary" [for]="'defaultMode-' + activeTab">Default mode</label>

      <input type="radio" class="btn-check" [attr.name]="'mode-' + activeTab" [id]="'reportMode-' + activeTab"
        autocomplete="off" [(ngModel)]="mode[activeTab]" value="report">
      <label class="btn btn-outline-secondary" [for]="'reportMode-' + activeTab">Report mode</label>
    </div>

    <!-- Mode Toggle -->
    <!-- <div class="btn-group" role="group">
      <input type="radio" class="btn-check" name="mode" id="defaultMode" autocomplete="off" checked>
      <label class="btn btn-outline-primary" for="defaultMode">Default mode</label>

      <input type="radio" class="btn-check" name="mode" id="reportMode" autocomplete="off">
      <label class="btn btn-outline-secondary" for="reportMode">Report mode</label>
    </div> -->

    <!-- Inside each tab, pass a unique identifier -->
    <!-- <div class="btn-group" role="group">
      <input type="radio" class="btn-check" [attr.name]="'mode-' + activeTab" [id]="'defaultMode-' + activeTab"
        autocomplete="off" [(ngModel)]="mode[activeTab]" value="default">
      <label class="btn btn-outline-primary" [for]="'defaultMode-' + activeTab">Default mode</label>

      <input type="radio" class="btn-check" [attr.name]="'mode-' + activeTab" [id]="'reportMode-' + activeTab"
        autocomplete="off" [(ngModel)]="mode[activeTab]" value="report">
      <label class="btn btn-outline-secondary" [for]="'reportMode-' + activeTab">Report mode</label>
    </div> -->


  </div>
  <table class="table">
    <thead>
      <tr>
        <th class="text-primary connector-column" [lang]="languageService.selectedLanguage()" sortable="name">
          <h5 class="table-header">{{ 'common.monitor.dashboard.connector' | translate }}</h5>
        </th>
        <th class=" text-primary workflow-column" [lang]="languageService.selectedLanguage()">
          <h5 class="table-header">{{ 'common.monitor.dashboard.ciLabel' | translate }}
            <app-build-badge-tooltip buildType="CI" />
          </h5>
        </th>
        <th class="text-primary workflow-column" [lang]="languageService.selectedLanguage()">
          <h5 class="table-header">{{ 'common.monitor.dashboard.devLabel' | translate }}
            <app-build-badge-tooltip buildType="DEV" />
          </h5>
        </th>
        <th class="text-primary workflow-column" [lang]="languageService.selectedLanguage()">
          <h5 class="table-header">{{ 'common.monitor.dashboard.e2eLabel' | translate }}
            <app-build-badge-tooltip buildType="E2E" />
          </h5>
        </th>
        <th class="text-primary" [lang]="languageService.selectedLanguage()">
          <h5 class="table-header">{{ 'common.monitor.dashboard.github' | translate }}
          </h5>
        </th>
      </tr>
    </thead>
    @if (displayedRepositories.length > 0) {
    <tbody>
      <tr *ngFor="let repo of displayedRepositories">
        <td class="align-middle">
          <a [href]="getMarketUrl(repo.name)" target="_blank" rel="noopener noreferrer">
            <p id="product-name">{{ repo.name }}</p>
          </a>
        </td>

        <td>
          <app-repo-test-result [workflow]="'CI'" [conclusion]="repo.ciConclusion" [repository]="repo"
            [mode]="mode[activeTab]">
          </app-repo-test-result>
        </td>
        <td>
          <app-repo-test-result [workflow]="'DEV'" [conclusion]="repo.devConclusion" [repository]="repo"
            [mode]="mode[activeTab]">
          </app-repo-test-result>
        </td>
        <td>
          <app-repo-test-result [workflow]="'E2E'" [conclusion]="repo.e2eConclusion" [repository]="repo"
            [mode]="mode[activeTab]">
          </app-repo-test-result>
        </td>
        <td class="align-middle">
          <a [href]="repo.htmlUrl" target="_blank" rel="noopener noreferrer">
            <i class="fa fa-external-link" aria-hidden="true"></i>
          </a>
        </td>
      </tr>
    </tbody>
    }
    @else if(displayedRepositories.length == 0 && !isLoading) {
    <tbody>
      <tr>
        <td colspan="12" class="border-0">
          <p class="text-primary m-0 text-center no-repositories" [lang]="languageService.selectedLanguage()">
            {{ 'common.monitor.dashboard.noRepositories' | translate }}
          </p>
        </td>
      </tr>
    </tbody>
    }
  </table>

  <div class="d-flex justify-content-between p-2" [lang]="languageService.selectedLanguage()">
    <ngb-pagination [collectionSize]="filteredRepositories.length" [(page)]="page" [pageSize]="pageSize"
      (pageChange)="refreshPagination()">
    </ngb-pagination>

    <select class="form-select pagination" [(ngModel)]="pageSize" (ngModelChange)="refreshPagination()">
      <option [ngValue]="10">{{ 'common.monitor.pagination.tenItems' | translate }}</option>
      <option [ngValue]="15">{{ 'common.monitor.pagination.fifteenItems' | translate }}</option>
      <option [ngValue]="20">{{ 'common.monitor.pagination.twentyItems' | translate }}</option>
    </select>
  </div>

  @if (isLoading) {
  <app-loading-spinner
    containerClasses="d-flex justify-content-center position-fixed align-items-center top-0 end-0 bottom-0 start-0 rounded overlay-background z-1"
    [key]="LoadingComponentId.MONITORING_REPO" />
  }
</div>
