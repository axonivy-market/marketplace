@if (isAuthenticated) {
  <div class="container"></div>
  <div class="admin-layout" [class.sidebar-open]="isSidebarOpen">
    <app-side-menu (openChange)="onSidebarStateChanged($event)"></app-side-menu>
    <div class="admin-main">
      <app-header (menuToggle)="onMenuToggle()"></app-header>

      <div class="admin-main__content">
        @if (showSyncJob) {
          <div class="table-responsive admin-main__table">
            <table class="table">
              <thead>
                <tr>
                  <th
                    class="text-primar"
                    [lang]="languageService.selectedLanguage()">
                    {{ 'common.admin.sync.action' | translate }}
                  </th>
                  <th
                    class="text-primary"
                    [lang]="languageService.selectedLanguage()">
                    {{ 'common.admin.sync.syncJob' | translate }}
                  </th>
                  <th
                    class="text-primary"
                    [lang]="languageService.selectedLanguage()">
                    {{ 'common.admin.sync.status' | translate }}
                  </th>
                  <th
                    class="text-primary"
                    [lang]="languageService.selectedLanguage()">
                    {{ 'common.admin.sync.lastRun' | translate }}
                  </th>
                  <th
                    class="text-primary"
                    [lang]="languageService.selectedLanguage()">
                    {{ 'common.admin.sync.completed' | translate }}
                  </th>
                  <th
                    class="text-primary"
                    [lang]="languageService.selectedLanguage()">
                    {{ 'common.admin.sync.message' | translate }}
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let job of jobs">
                  <td>
                    <button
                      type="button"
                      [lang]="languageService.selectedLanguage()"
                      class="btn border-0 sync-button text-center"
                      [ngClass]="
                        themeService.isDarkMode() ? 'btn-light' : 'btn-primary'
                      "
                      (click)="trigger(job)"
                      [disabled]="job.status === 'RUNNING'">
                      Sync
                    </button>
                  </td>
                  <td>{{ job.label }}</td>
                  <td>
                    <span [ngClass]="getStatusClass(job.status)">
                      {{ job.status ? (job.status | titlecase) : '' }}
                    </span>
                  </td>
                  <td>
                    {{
                      job.triggeredAt
                        ? (job.triggeredAt | date: 'dd.MM.yyyy HH:mm')
                        : ''
                    }}
                  </td>
                  <td>
                    {{
                      job.completedAt
                        ? (job.completedAt | date: 'dd.MM.yyyy HH:mm')
                        : ''
                    }}
                  </td>
                  <td class="message-cell">
                    <div>{{ job.message || '' }}</div>
                    <div class="small text-muted" *ngIf="job.reference">
                      Ref: {{ job.reference }}
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        }

        <router-outlet></router-outlet>
      </div>
    </div>
  </div>
} @else {
  <div class="token-container">
    <div class="header">
      <h2 class="text-primary text-center">Admin Dashboard</h2>
      <h3 class="text-primary text-center">
        Enter token to access sync functions
      </h3>
    </div>
    <div class="token-input-container">
      <h3 class="text-primary">Token</h3>
      <div>
        <input
          id="token-input"
          type="password"
          [(ngModel)]="token"
          placeholder="Enter token" />
        <button
          class="btn-primary"
          (click)="onSubmit()"
          [ngClass]="themeService.isDarkMode() ? 'text-dark' : 'text-light'">
          Proceed
        </button>
        @if (errorMessage) {
          <div class="error-message">{{ errorMessage }}</div>
        }
      </div>
    </div>
  </div>
}
